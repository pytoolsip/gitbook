# 事件分发机制

## 事件分发意义
不同模块之间可通过分发事件的方式，相互调用逻辑处理接口，在保证功能性的前提下，减少了模块之间逻辑的耦合性，使得代码结构清晰，易于理解。

## 机制实现
这里采用一般的实现方式：

  * 首先，创建一个全局变量（保证在工程中的每个模块都能拿到）作为事件管理器；
  * 其次，创建事件ID的相关配置文件，允许开发者新建ID配置；
  * 开发者在代码中，通过调用事件管理器的注册事件接口进行事件注册，而事件管理器则会将该注册信息保存当运行内存中；
  * 开发者在代码中，通过调用事件管理器的分发事件接口进行事件分发，而事件管理器则会根据之前的注册信息，调用信息相应的回调函数；
  * 最后，开发者在销毁某个注册了事件的类时，必须要注销之前的注册事件，否则会出现调用销毁对象的方法而抛错问题。

## 用法
### 新增事件ID
目前仅支持在`common/core/eventDispatchCore/EventId.py`中新增事件ID。  
这样，会导致事件ID的定义混乱且难以管理，且无法满足`common`修改权限的开发者进行工具开发，故而在之后会调整事件ID的新增方式。

### 注册事件
通过调用以下的语句来注册事件。其中_GG为全局包。_
```
_GG("EventDispatcher").register(eventId, object, callbackName);
```

### 注销事件
通过调用以下的语句来注销事件。
```
_GG("EventDispatcher").unregister(eventId, object, callbackName);
```

### 分发事件
通过调用以下的语句来注销事件。其中data是字典类型的数据。
```
_GG("EventDispatcher").dispatch(eventId, data);
```